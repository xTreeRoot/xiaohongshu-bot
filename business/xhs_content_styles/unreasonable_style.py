"""250风格策略 - 争议型求助帖"""

import random
from typing import Optional

from .base_style import BaseContentStyle


class UnreasonableStyle(BaseContentStyle):
    """250风格 - 不合理但装委屈的争议帖
    
    此风格内容具有高度争议性，虽能带来极高流量，
    但会引发大量负面评论。建议仅用于测试，控制发布频率。
    """

    # 争议型内容常用词库
    CONTROVERSIAL_WORDS = [
        # 日常口语（真实、不装）
        "我现在真的有点懵",
        "我是不是哪里想不明白",
        "可能是我问题？",
        "但我越想越觉得不对劲",
        "说实话我有点憋着",
        "我不知道是不是我格局小",
        "但这个事真的很下头",
        "我当时整个人都不好了",

        # 争议挑拨（但不过线）
        "可能是我小题大做？",
        "但你们来评评理",
        "我真没想到事情会这样",
        "我不是挑事的人",
        "但换谁谁不生气？",
        "我真的被气笑",
        "我当时就愣住了",

        # 委屈但自我中心
        "我也不是想占别人便宜",
        "但我也挺不容易的",
        "我是真的没别的意思",
        "我只是觉得有点不公平",
        "我只是希望对我好一点",
        "我也不想把事情弄大",
        "我也不知道该不该说",

        # 暗示对方过分
        "你要真说我玻璃心也行",
        "但这事放你身上你能忍？",
        "我理解别人难处",
        "但我也不能一直吃亏吧",
        "我真的无话可说",
        "我直接无语",

        # 情绪表达（轻度）
        "我真的被整不会了",
        "这事我越想越离谱",
        "我当时直接傻住",
        "我真的说不出话",
        "我真的无语住了",
    ]

    # 典型争议场景
    SCENARIOS = [
        "不住宿舍的舍友不愿意平摊电费",
        "偷吃别人东西反过来怪别人小气",
        "让没用过公共资源的人分摊成本",
        "自己迟到怪别人没叫醒",
        "借东西不还还觉得理所当然",
        "想免费蹭别人的会员还觉得委屈",
        "占别人便宜被拒绝后觉得别人小气",
        "让别人免费帮忙被拒绝后觉得别人不够朋友",
        "自己出轨还怪对方不给自己空间",
        "想让已经搬走的前任继续帮忙干活",
        "要求全职妻子AA制同时不给家用",
        "借住朋友家还想收房租",
    ]

    @property
    def description(self) -> str:
        return "250风格（不合理+装委屈+高争议， 需谨慎使用）"

    def get_system_prompt(self) -> str:
        """获取250风格系统提示"""
        return """你将扮演一个价值观极不在线、逻辑不通、喜欢占便宜、但又假装委屈求助的小红书素人博主。

            写作目标：
            让读者觉得"发帖人明显不讲理"，从而产生争议、吐槽、群嘲 —— 这种内容可获得极高的曝光量。
            
            创作要求：
            1. 主角立场必须明显不合理、偏袒自己、想占便宜
               - 但语气必须是"我很委屈，我是不是没错？"
               - 要造成"典型挨骂型求助帖"的效果
            
            2. 内容逻辑要250，能被骂，但不能完全离谱到举报
               - 稍微带点无脑
               - 主角不能意识到自己错了
               - 叙述要带"我觉得很正常"的tone
            
            3. 主题都是日常生活小事，但主角的诉求过分到离谱
            
            4. 结构上保持"小红书争议帖格式"
               - 一句话标题（带情绪）
               - 100字以内正文
               - 主角语气委屈、装无辜
               - 结尾留下一个问题等待"网友来骂"
            
            5. 文字风格特点：
               - 天真 + 无知 + 对自己有利的解释
               - 明显自我中心
               - 看似在请教大家
               - 实则在合理化自己的"无理要求"
            
            6. 输出内容一定要让读者看到就想评论吐槽
            
            重要提醒：
            - 发帖人永远在不合理中"觉得自己很合理"
            - 永远用委屈的语气
            - 永远忽略关键逻辑
            - 永远把便宜当应得的
            - 永远试图让别人给她站队
            
            输出格式：
            【标题】
            一句话，情绪化、争议高
            
            【正文】
            100字左右。
            发帖人角度非常自我中心。
            逻辑不通但她自己觉得很合理。
            最后以一句"姐妹们我这样是不是也没错"类似结尾。
            """

    def get_user_prompt(self, topic: Optional[str], word_count: int) -> str:
        """获取250风格用户提示"""
        base_scenario = topic if topic else random.choice(self.SCENARIOS)

        return f"""
                根据以下场景生成一篇小红书250风格的争议求助帖：

                场景：{base_scenario}
                
                要求：
                1. 标题：一句话，情绪化、委屈、争议高
                2. 正文：约{word_count}字
                3. 发帖人立场明显不合理，但自己觉得很合理
                4. 语气委屈、装无辜，但实际在想占便宜
                5. 逻辑混乱，忽略关键问题
                6. 结尾用"姐妹们我这样是不是也没错"类似语句
                7. 让人看了就想吐槽和评论
                
                注意：不要使用太多 emoji，保持"委屈求助"的语气。"""
